<!DOCTYPE html>

<html>
	<head>
		<!-- Matomo Tag Manager -->
		<script>
			var _mtm = window._mtm = window._mtm || [];
			_mtm.push({'mtm.startTime': (new Date().getTime()), 'event': 'mtm.Start'});
			var d=document, g=d.createElement('script'), s=d.getElementsByTagName('script')[0];
			g.async=true; g.src='https://cdn.matomo.cloud/businessdev.matomo.cloud/container_v7xJrAFg.js'; s.parentNode.insertBefore(g,s);
		</script>
		<!-- End Matomo Tag Manager -->
		<script src="{{ site.baseurl }}/scripts/anchor.min.js"></script>
		<meta charset="utf-8">
		<meta name="viewport" content="width=device-width, initial-scale=1">

		<title>{% if page.title %} {% t titles.{{ page.title }}%} | {% endif %}365 business development</title>

		{% seo %}
		{% feed_meta %}

		<link rel="stylesheet" href="{{ site.baseurl }}/css/main.css">		
		<link href="/assets/fontawesome-pro/css/fontawesome.css" rel="stylesheet">
		<link href="/assets/fontawesome-pro/css/light.css" rel="stylesheet">
		<link href="/assets/fontawesome-pro/css/thin.css" rel="stylesheet">
		<link href="/assets/fontawesome-pro/css/solid.css" rel="stylesheet">
		<link href="/assets/fontawesome-pro/css/regular.css" rel="stylesheet">
		<link href="/assets/fontawesome-pro/css/duotone.css" rel="stylesheet">
		<link rel="icon" type="image/png" href="{{ site.baseurl_root }}/assets/images/favicon.png">
	</head>

	<body>
		<div style="position: fixed; height: 32px; top: 0; left: 0; background-color: #23282d; width: 100%; font-size: 13px; z-index: 9999;">
			<div style="float: left; width: 70%; box-sizing: border-box; color: rgb(209, 209, 209); font-weight: 600; height: 100%;">
				<div id="page-scroll-title">
				</div>
			</div>
			<div style="float: left; width: 30%; margin-right: 0px; box-sizing: border-box; direction: rtl;">
				{% for lang in site.languageFlags %}
				{% if page.permalink %}				
				<a style="color: whitesmoke; padding-right: 10px;" href="{{ site.baseurl_root }}/{{ lang[0] }}{{ page.permalink }}"><img src="{{ lang[1] }}" width="16" height="11" style="width: 16px; height: 11px; margin-top: 10px;"></a>
				{% else %}
				<a style="color: whitesmoke; padding-right: 10px;" href="{{ site.baseurl_root }}/{{ lang[0] }}/"><img src="{{ lang[1] }}" width="16" height="11" style="width: 16px; height: 11px; margin-top: 10px;"></a>
				{% endif %}
				{% endfor %}
			</div>
		</div>
		<header>			
			<div style="background-color: #ffffff; box-sizing: border-box; border: 0; border-bottom: 1px solid rgba(0, 0, 0, 0.075); border-left: 5px solid transparent; box-shadow: inset -10px 0 10px -10px rgba(0, 0, 0, 0.1); padding-top: 40px;">
				<a href="{{ site.baseurl }}/"><img src="{{ site.baseurl_root }}/assets/images/emblem.png" width="300" alt="{{ site.title }} logo"></a>
			</div>
			<button type="button" class="open-nav" id="open-nav"></button>			
			<!-- 
			<h1>	{{ site.title }}
			</h1>
			 -->
			<form action="{{ site.baseurl }}/search/" method="get">
				<input type="text" name="q" id="search-input" placeholder="Search" autofocus>
				<input type="submit" value="Search" style="display: none;">
			</form>

			<nav {% if site.show_full_navigation %}class="full-navigation"{% endif %}>
				<ul>
					<li class="nav-item top-level {% if page.url == '/' %}current{% endif %}">
						{% assign home = site.html_pages | where: 'url', '/' | first %}
						<a href="{{ site.baseurl }}/">{% t category.{{ home.title }} %}</a>
					</li>
				</ul>

				<ul>
					{% assign grouped = site.docs | group_by: 'category' %}
					{% for group in grouped %}
						<li class="nav-item top-level {% if group.name == page.category %}current{% endif %}">
							{% assign items = group.items | sort: 'order' %}
							<a href="{{ site.baseurl }}/{{ group.name }}/">{% t category.{{ group.name }} %}</a>
							<ul>
								{% for item in items %}
									{% if item.show == false %} {% continue %} {% endif %}
									<li class="nav-item {% if item.url == page.url %}current{% endif %}"><a href="{{ site.baseurl }}{{ item.url }}">{% t titles.{{ item.title }} %}</a></li>
								{% endfor %}
							</ul>
						</li>
					{% endfor %}
				</ul>
				<ul>
					<li class="nav-item top-level">
						<a href="https://downloads.365businessdev.com">{% t titles.downloads %}</a>
					</li>
					<li class="nav-item top-level {% if page.url == '/al-developer/' %}current{% endif %}">
						{% assign changelog = site.html_pages | where: 'url', '/en-US/al-developer/' | first %}
						<a href="{{ site.baseurl }}/al-developer/">AL Developer</a>
					</li>
					<li class="nav-item top-level {% if page.url == '/new-and-planned/' %}current{% endif %}">
						{% assign newAndPlanned = site.html_pages | where: 'url', '/new-and-planned/' | first %}
						<a href="{{ site.baseurl }}/new-and-planned/">{% t titles.{{ newAndPlanned.title }} %}</a>
					</li>
				</ul>
			</nav>
		</header>

		<section class="main">
			<div class="page-header">
				<h2>{% if page.category %}{% t category.{{ page.category }} %}{% else %}{{ site.title }}{% endif %}</h2>
				<h3>{% t titles.{{ page.title }}%}</h3>
			</div>
			<article class="content">
				{{ content }}
			</article>
		</section>

		<script>
			document.getElementById("open-nav").addEventListener("click", function () {
				document.body.classList.toggle("nav-open");
			});

			// show notification for language redirection
			function findGetParameter(parameterName) {
				var result = null,
					tmp = [];
				var items = location.search.substr(1).split("&");
				for (var index = 0; index < items.length; index++) {
					tmp = items[index].split("=");
					if (tmp[0] === parameterName) result = decodeURIComponent(tmp[1]);
				}
				return result;
			}
			if (findGetParameter('errorCode') == '404') {
				let notification = `<blockquote><p><strong>Page not found.</strong><br>This is not the web page you are looking for. We are sorry, we could not find the page you requested.</p></blockquote>`;

				let content = document.getElementsByClassName('content')[0].innerHTML;
				document.getElementsByClassName('content')[0].innerHTML = notification + content;
			}
			if (findGetParameter('unsupportedLocale') !== null) {
				let notification = `<blockquote><p>This page is currently not available in the selected language '<strong>${findGetParameter('unsupportedLocale')}</strong>'. You have been automatically redirected to a supported language version matching your browser language.</p></blockquote>`;

				let content = document.getElementsByClassName('content')[0].innerHTML;
				document.getElementsByClassName('content')[0].innerHTML = notification + content;
			}

			// anchor.js implementation
			document.addEventListener("DOMContentLoaded", function(event) {
				anchors.add('article section h1, h2, h3, h4, h5, h6');
				anchors.options.placement = 'left';
			});

			document.body.onscroll = function() {
				let pageScrollTitle = document.getElementById('page-scroll-title');
				if (pageScrollTitle === null) {
					return;
				}
				
				let headerElements = document.querySelectorAll("h1, h2, h3, h4, h5, h6");
				pageScrollTitle.innerText = headerElements[0].innerText;
				let lastHeaderTitle = '';

				// console.log(`document.documentElement.scrollTop: ${document.documentElement.scrollTop}`);
				if (document.documentElement.scrollTop >= 100) {
					pageScrollTitle.style.display = 'block';

					for (let i = 1; i < headerElements.length; i++) {
						const headerElement = headerElements[i];
						if (headerElement.offsetTop < document.documentElement.scrollTop) {
							lastHeaderTitle = headerElement.innerText;
						}
					}

					if (lastHeaderTitle !== '') {
						pageScrollTitle.innerText = pageScrollTitle.innerText + ' - ' + lastHeaderTitle;
					}

				} else {
					pageScrollTitle.style.display = 'none';
				}
			}
		</script>
	</body>
</html>
